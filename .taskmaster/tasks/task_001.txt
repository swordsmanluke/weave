# Task ID: 1
# Title: Refactor Upvalue Data Structures
# Status: done
# Dependencies: None
# Priority: high
# Description: Redesign upvalue storage to distinguish between open upvalues (stack references) and closed upvalues (heap-allocated values)
# Details:
Modify WeaveUpvalue in src/weave/vm/types/ to support both open and closed states. Open upvalues should reference stack locations while parent function is active. Closed upvalues should be heap-allocated Rc<RefCell<WeaveValue>> when parent scope ends. Add state tracking enum (Open/Closed) and implement conversion methods. Use existing heap structure Vec<Rc<RefCell<WeaveValue>>> for closed upvalues.

# Test Strategy:
Unit tests for upvalue state transitions, memory allocation tests, verify open upvalues reference correct stack slots and closed upvalues are properly heap-allocated
