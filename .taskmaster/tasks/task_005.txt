# Task ID: 5
# Title: Implement Upvalue Closing Mechanism
# Status: done
# Dependencies: 1, 4
# Priority: high
# Description: Add functionality to move upvalues from stack to heap when their defining scope ends
# Details:
Implement upvalue closing mechanism that moves open upvalues to heap when parent function scope ends. Add close_upvalues method to VM that converts stack-based upvalues to heap-allocated Rc<RefCell<WeaveValue>>. Hook into function return and scope exit points to trigger upvalue closing. Ensure closed upvalues maintain reference semantics for shared access across multiple closures. Use existing heap structure for efficient memory management.

# Test Strategy:
Test upvalue persistence after parent function returns, verify heap allocation of closed upvalues, test shared upvalue access across multiple closures
